DBMS-3


Assignment 1:


1.select distinct  books.accession_no,members.member_id ,members.member_num,titles.title_nm ,
book_issue.due_dt,book_issue.issue_dt,
TIMESTAMPDIFF(MONTH,book_return.issue_dt,IFNULL(book_return.return_dt,CURRENT_TIMESTAMP)) from book_issue 
INNER JOIN  members on book_issue.member_id=members.member_id INNER JOIN books on book_issue.accession_no=books.accession_no 
INNER JOIN titles on books.title_id=titles.title_id
LEFT JOIN book_return on book_return.issue_dt=book_issue.issue_dt and
 book_return.accession_no=book_issue.accession_no and 
book_return.member_id=book_issue.member_id   
  
 where TIMESTAMPDIFF(MONTH,book_return.issue_dt,IFNULL(book_return.return_dt,CURRENT_TIMESTAMP))>=2  order by members.member_num,titles.title_nm  ; 
 

2.select member_num,length(member_num) from members where length(member_num)>=(select max(length(member_num)) from members );
3.select count(accession_no) from book_issue;

Assignment 2:
1.select subjects.subject_id,subject_nm,count(books.accession_no) as No_Of_Books from books INNER JOIN titles 
 on books.title_id =titles.title_id INNER JOIN subjects on titles.subject_id=subjects.subject_id
group by (subject_id);

2.select accession_no,member_id  from book_issue where TIMESTAMPDIFF(month,issue_dt,due_dt)>=2;
3.select accession_no,price from books where price >(select min(price) from books )

Assignment 3:



1.select group_concat(distinct m. cateogry), group_concat(m.countmember) from (
SELECT cateogry,count(cateogry) as countmember from members group by cateogry) as m;
2.select titles.title_id,titles.title_nm  from 
titles INNER JOIN books on titles.title_id =books.title_id INNER JOIN book_issue
on books.accession_no=book_issue.accession_no  
group by books.title_id having count(book_issue.accession_no)>=2; 

3.select books.accession_no,books.price,members.member_num  from 
members INNER JOIN book_issue on members.member_id =book_issue.member_id INNER JOIN books
on books.accession_no=book_issue.accession_no  
where members.cateogry  not Like '%F%';

4.select distinct authors.author_id,authors.author_nm from 
authors INNER JOIN title_author on authors.author_id =title_author.author_id INNER JOIN titles
on titles.title_id=title_author.title_id INNER JOIN books on titles.title_id=books.title_id;

